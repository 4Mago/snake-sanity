{"version":3,"sources":["../../src/components/Input.js"],"names":["NOOP","cachedSecrets","token","secretKey","enableSignedUrls","signingKeyId","signingKeyPrivate","validateSecrets","secrets","getSecrets","Promise","resolve","isInitialSetup","needsSetup","then","exists","MuxVideoInput","Component","constructor","props","assetDocument","confirmRemove","deleteOnMuxChecked","deleteAssetDocumentChecked","error","hasFocus","isLoading","isSigned","showSetup","showBrowser","videoReadyToPlay","handleFocus","setState","state","pollInterval","setInterval","assetId","response","data","client","patch","_id","set","status","commit","returnDocuments","catch","event","prevState","showStetup","result","onChange","PatchEvent","from","asset","_ref","document","setupAssetListener","preventDefault","stopPropagation","unsetAsset","reject","unset","delete","videoPlayer","current","currentTime","getVideoElement","thumbTime","options","time","width","height","fitMode","thumb","playbackId","value","setupButton","React","createRef","video","removeVideoButton","componentDidMount","componentWillUnmount","subscription","unsubscribe","clearInterval","getAsset","pipe","handleRemoveVideo","Error","errors","messages","join","pollMux","playback_ids","policy","subscribe","renderSetup","setup","handleSaveSetup","handleCancelSaveSetup","renderSetupButton","styles","setupButtonContainer","handleSetupButtonClicked","SetupIcon","renderSetupNotice","warning","renderAsset","isSignedAlert","alert","handleVideoReadyToPlay","renderVideoButtons","readOnly","handleBrowseButton","handleSetThumbButton","handleRemoveVideoButtonClicked","popoverAnchor","handleCancelRemove","confirmDeletePopover","confirmDeletePopoverButtons","deleteCheckboxRow","handleDeleteOnMuxCheckBoxClicked","handleDeleteAssetDocumentCheckBoxClicked","renderThumbPreview","handleCloseThumbPreview","thumbPreview","renderBrowser","handleCloseBrowser","handleSelectAsset","renderError","handleErrorClose","message","render","type","level","markers","root","header","title","description","formField","handleBlur","handleOnUploadComplete"],"mappings":"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","sourcesContent":["import React, {Component, Fragment} from 'react'\nimport Button from 'part:@sanity/components/buttons/default'\nimport {of} from 'rxjs'\nimport {tap} from 'rxjs/operators'\nimport {withDocument} from 'part:@sanity/form-builder'\n\nimport {fetchSecrets} from '../actions/secrets'\nimport {getAsset, deleteAsset} from '../actions/assets'\nimport getPosterSrc from '../util/getPosterSrc'\n\nimport client from 'part:@sanity/base/client'\nimport {observePaths} from 'part:@sanity/base/preview'\nimport Dialog from 'part:@sanity/components/dialogs/default'\nimport FullscreenDialog from 'part:@sanity/components/dialogs/fullscreen'\nimport DialogContent from 'part:@sanity/components/dialogs/content'\n\nimport PatchEvent, {set, setIfMissing} from 'part:@sanity/form-builder/patch-event'\nimport ButtonCollection from 'part:@sanity/components/buttons/button-collection'\nimport Checkbox from 'part:@sanity/components/toggles/checkbox'\nimport DefaultButton from 'part:@sanity/components/buttons/default'\nimport FormField from 'part:@sanity/components/formfields/default'\nimport PopOver from 'part:@sanity/components/dialogs/popover'\nimport Alert from 'part:@sanity/components/alerts/alert'\nimport SetupIcon from 'part:@sanity/base/plugin-icon'\nimport Spinner from 'part:@sanity/components/loading/spinner'\n\nimport Setup from './Setup'\nimport Video from './Video'\nimport SelectAsset from './SelectAsset'\nimport MuxLogo from './MuxLogo'\nimport Uploader from './Uploader'\nimport styles from './Input.css'\n\nconst NOOP = () => {\n  /* intentional noop */\n}\n\nconst cachedSecrets = {\n  token: null,\n  secretKey: null,\n  enableSignedUrls: false,\n  signingKeyId: null,\n  signingKeyPrivate: null,\n}\n\nfunction validateSecrets(secrets) {\n  if (secrets.token === null) return true\n  if (secrets.secretKey === null) return true\n\n  return false\n}\n\nfunction getSecrets() {\n  if (cachedSecrets.token) {\n    return Promise.resolve({\n      isInitialSetup: true,\n      needsSetup: false,\n      secrets: cachedSecrets,\n    })\n  }\n  return fetchSecrets()\n    .then(({secrets, exists}) => {\n      cachedSecrets.token = secrets.token\n      cachedSecrets.secretKey = secrets.secretKey\n      cachedSecrets.enableSignedUrls = secrets.enableSignedUrls\n      cachedSecrets.signingKeyId = secrets.signingKeyId\n      cachedSecrets.signingKeyPrivate = secrets.signingKeyPrivate\n      return {\n        isInitialSetup: !exists,\n        needsSetup: validateSecrets(cachedSecrets),\n        secrets: cachedSecrets,\n      }\n    })\n}\n\nexport default withDocument(\n  class MuxVideoInput extends Component {\n    state = {\n      assetDocument: null,\n      confirmRemove: false,\n      deleteOnMuxChecked: true,\n      deleteAssetDocumentChecked: true,\n      error: null,\n      hasFocus: false,\n      isInitialSetup: true,\n      isLoading: 'secrets',\n      needsSetup: true,\n      secrets: null,\n      isSigned: false,\n      showSetup: false,\n      showBrowser: false,\n      videoReadyToPlay: false,\n    }\n\n    constructor(props) {\n      super(props)\n      getSecrets().then(({secrets, isInitialSetup, needsSetup}) => {\n        this.setState({\n          secrets,\n          isInitialSetup,\n          needsSetup,\n          isLoading: props.value?.asset, // If there is an asset continue loading\n        })\n      }).catch((error) => this.setState({ error }))\n      \n      this.setupButton = React.createRef()\n      this.pollInterval = null\n      this.video = React.createRef()\n      this.removeVideoButton = React.createRef()\n      this.videoPlayer = React.createRef()\n    }\n\n    componentDidMount() {\n      this.setupAssetListener()\n    }\n\n    componentWillUnmount() {\n      if (this.subscription) {\n        this.subscription.unsubscribe()\n      }\n      if (this.pollInterval) {\n        clearInterval(this.pollInterval)\n        this.pollInterval = null\n      }\n    }\n\n    focus = () => {\n      this.handleFocus();\n    }\n\n    handleFocus = () => {\n      this.setState({hasFocus: true})\n    }\n\n    handleBlur = () => {\n      this.setState({hasFocus: false})\n    }\n\n    getAsset() {\n      const {value} = this.props\n      return value ? value.asset : null\n    }\n\n    setupAssetListener() {\n      if (this.subscription) {\n        this.subscription.unsubscribe()\n      }\n      this.setState({videoReadyToPlay: false})\n      const asset = this.getAsset()\n      if (!asset) {\n        return\n      }\n      this.subscription = observePaths(asset, [\n        'thumbTime',\n        'data',\n        'assetId',\n        'playbackId',\n        'status',\n      ])\n        .pipe(\n          tap((assetDocument) => {\n            this.setState({assetDocument})\n            if (assetDocument && assetDocument.status === 'errored') {\n              clearInterval(this.pollInterval)\n              this.pollInterval = null\n              // todo: use client.observable\n              return this.handleRemoveVideo().then(() => {\n                this.setState({\n                  isLoading: false,\n                  error: new Error(assetDocument.data.errors.messages.join(' ')),\n                })\n              })\n            }\n            if (assetDocument && assetDocument.status === 'preparing') {\n              this.pollMux()\n            }\n            if (assetDocument && assetDocument.status === 'ready') {\n              clearInterval(this.pollInterval)\n              this.pollInterval = null\n            }\n\n            // eslint-disable-next-line camelcase\n            const isSigned = assetDocument?.data?.playback_ids[0]?.policy === 'signed'\n            this.setState({assetDocument, isSigned, isLoading: false})\n            return of(assetDocument)\n          })\n        )\n        .subscribe()\n    }\n\n    pollMux = () => {\n      const assetDocument = this.state.assetDocument\n      if (!assetDocument) {\n        return\n      }\n      if (this.pollInterval) {\n        return\n      }\n      this.pollInterval = setInterval(() => {\n        getAsset(assetDocument.assetId)\n          .then((response) => {\n            const props = response.data\n            client\n              .patch(assetDocument._id)\n              .set({\n                status: props.status,\n                data: props,\n              })\n              .commit({returnDocuments: false})\n          })\n          .catch((error) => {\n            this.setState({error})\n          })\n      }, 2000)\n    }\n\n    handleSetupButtonClicked = (event) => {\n      this.setState((prevState) => ({showSetup: !prevState.showStetup}))\n    }\n\n    handleSaveSetup = ({token, secretKey, enableSignedUrls, signingKeyId, signingKeyPrivate}) => {\n      cachedSecrets.token = token\n      cachedSecrets.secretKey = secretKey\n      cachedSecrets.enableSignedUrls = enableSignedUrls\n      cachedSecrets.signingKeyId = signingKeyId\n      cachedSecrets.signingKeyPrivate = signingKeyPrivate\n      this.setState({\n        showSetup: false,\n        secrets: cachedSecrets,\n        needsSetup: validateSecrets(cachedSecrets),\n      })\n    }\n\n    handleCancelSaveSetup = () => {\n      this.setState({showSetup: false})\n    }\n\n    handleOnUploadComplete = (result) => {\n      const {onChange} = this.props\n      const {_id} = result\n      onChange(\n        PatchEvent.from([setIfMissing({asset: {_ref: _id}}, []), set({_ref: _id}, ['asset'])])\n      )\n      this.setState({assetDocument: result.document}, () => {\n        this.setupAssetListener()\n      })\n    }\n\n    handleRemoveVideoButtonClicked = (event) => {\n      event.preventDefault()\n      event.stopPropagation()\n      this.setState({confirmRemove: true})\n    }\n\n    handleRemoveVideo = () => {\n      const {assetDocument} = this.state\n      this.setState({isLoading: true})\n      const unsetAsset = () => {\n        return new Promise((resolve, reject) => {\n          this.setState(\n            {\n              assetDocument: null,\n              confirmRemove: false,\n              isLoading: false,\n            },\n            () => {\n              if (this.state.deleteOnMuxChecked || this.state.deleteAssetDocumentChecked) {\n                return client\n                  .patch(this.props.document._id)\n                  .unset(['video'])\n                  .commit({returnDocuments: false})\n                  .then(() => {\n                    if (!assetDocument) {\n                      return resolve()\n                    }\n                    return client\n                      .delete(assetDocument._id)\n                      .then(() => {\n                        resolve()\n                      })\n                      .catch((error) => {\n                        reject(error)\n                      })\n                  })\n              }\n              return resolve()\n            }\n          )\n        })\n      }\n      return unsetAsset()\n        .then(() => {\n          if (this.state.deleteOnMuxChecked) {\n            return deleteAsset(assetDocument.assetId).catch((error) => {\n              this.setState({error})\n            })\n          }\n          return true\n        })\n        .catch((error) => {\n          this.setState({error})\n        })\n    }\n\n    handleCancelRemove = (event) => {\n      this.setState({\n        confirmRemove: false,\n        deleteOnMuxChecked: true,\n        deleteAssetDocumentChecked: true,\n      })\n    }\n\n    handleDeleteOnMuxCheckBoxClicked = (event) => {\n      this.setState((prevState) => ({\n        deleteOnMuxChecked: !prevState.deleteOnMuxChecked,\n      }))\n    }\n\n    handleDeleteAssetDocumentCheckBoxClicked = (event) => {\n      this.setState((prevState) => ({\n        deleteAssetDocumentChecked: !prevState.deleteAssetDocumentChecked,\n      }))\n    }\n\n    handleSetThumbButton = (event) => {\n      if (!this.videoPlayer.current) {\n        return\n      }\n      const {assetDocument, isSigned} = this.state\n      const currentTime = this.videoPlayer.current.getVideoElement().currentTime\n      client\n        .patch(assetDocument._id)\n        .set({\n          thumbTime: currentTime,\n        })\n        .commit({returnDocuments: false})\n        .then((response) => {\n          const options = {\n            time: currentTime,\n            width: 320,\n            height: 320,\n            fitMode: 'crop',\n            isSigned,\n            signingKeyId: cachedSecrets.signingKeyId,\n            signingKeyPrivate: cachedSecrets.signingKeyPrivate,\n          }\n\n          const thumb = getPosterSrc(assetDocument.playbackId, options)\n\n          this.setState({thumb})\n        })\n        .catch((error) => {\n          this.setState({error})\n        })\n    }\n\n    handleErrorClose = (event) => {\n      if (event) {\n        event.preventDefault()\n      }\n      this.setState({\n        error: null,\n      })\n    }\n\n    handleCloseThumbPreview = (event) => {\n      this.setState({thumb: null})\n    }\n\n    handleBrowseButton = (event) => {\n      this.setState({showBrowser: true})\n    }\n\n    handleCloseBrowser = (event) => {\n      this.setState({showBrowser: false})\n    }\n\n    handleSelectAsset = (asset) => {\n      const {onChange} = this.props\n      onChange(\n        PatchEvent.from([\n          setIfMissing({asset: {_ref: asset._id}}, []),\n          set({_ref: asset._id}, ['asset']),\n        ])\n      )\n      this.setState({showBrowser: false, assetDocument: asset}, () => {\n        this.setupAssetListener()\n      })\n    }\n\n    handleVideoReadyToPlay = () => {\n      this.setState({videoReadyToPlay: true})\n    }\n\n    renderSetup() {\n      const {secrets} = this.state\n      const setup = (\n        <Setup\n          secrets={secrets ? secrets : null}\n          onSave={this.handleSaveSetup}\n          onCancel={this.handleCancelSaveSetup}\n        />\n      )\n\n      return (\n        <PopOver\n          color=\"default\"\n          useOverlay\n          onEscape={this.handleCancelSaveSetup}\n          onClickOutside={this.handleCancelSaveSetup}\n          padding=\"large\"\n        >\n          {setup}\n        </PopOver>\n      )\n    }\n\n    renderSetupButton() {\n      const {isLoading, showSetup, needsSetup} = this.state\n      const renderSetup = !isLoading && showSetup\n      return (\n        <div className={styles.setupButtonContainer}>\n          <Button\n            color={needsSetup ? 'danger' : 'primary'}\n            onClick={this.handleSetupButtonClicked}\n            icon={SetupIcon}\n            kind=\"simple\"\n            title=\"Configure MUX API access\"\n            tabIndex={1}\n          />\n          {renderSetup && this.renderSetup()}\n        </div>\n      )\n    }\n\n    renderSetupNotice() {\n      const {isLoading, needsSetup, isInitialSetup} = this.state\n      const renderSetupNotice = needsSetup\n      if (isLoading || !renderSetupNotice) {\n        return null\n      }\n      return (\n        <div className={styles.warning}>\n          <MuxLogo />\n          {isInitialSetup && (\n            <p>\n              Looks like this is the first time you are using the MUX video plugin in this dataset.\n              Great!\n            </p>\n          )}\n          <p>Before you can upload video, you must set your MUX credentials.</p>\n          <p>Click the plugin button in the field title to open Setup.</p>\n        </div>\n      )\n    }\n\n    // eslint-disable-next-line complexity\n    renderAsset() {\n      const {assetDocument, isSigned} = this.state\n      const renderAsset = !!assetDocument\n      if (!renderAsset) {\n        return null\n      }\n      const isSignedAlert = isSigned ? (\n        <div className={styles.alert}>\n          <Alert title=\"Note\" color=\"success\">\n            This mux asset is using a signed url\n          </Alert>\n        </div>\n      ) : null\n      return (\n        <>\n          {isSignedAlert}\n          <Video\n            assetDocument={assetDocument}\n            ref={this.videoPlayer}\n            onReady={this.handleVideoReadyToPlay}\n            onCancel={this.handleRemoveVideo}\n          />\n        </>\n      )\n    }\n\n    renderVideoButtons() {\n      const {assetDocument, confirmRemove} = this.state\n      const {readOnly} = this.props\n      if (assetDocument && assetDocument.status === 'ready' && !readOnly) {\n        return (\n          <Fragment>\n            <DefaultButton\n              inverted\n              kind=\"default\"\n              onClick={this.handleBrowseButton}\n              title=\"Select a previous uploaded video\"\n            >\n              Browse\n            </DefaultButton>\n\n            <DefaultButton\n              inverted\n              disabled={this.state.videoReadyToPlay === false}\n              kind=\"default\"\n              onClick={this.handleSetThumbButton}\n              title=\"Set thumbnail image from the current video position\"\n            >\n              Set thumb\n            </DefaultButton>\n\n            <DefaultButton\n              ref={this.removeVideoButton}\n              inverted\n              kind=\"default\"\n              color=\"danger\"\n              onClick={confirmRemove ? NOOP : this.handleRemoveVideoButtonClicked}\n            >\n              Remove\n              <div className={styles.popoverAnchor}>\n                {confirmRemove && (\n                  <PopOver\n                    color=\"default\"\n                    useOverlay\n                    onEscape={this.handleCancelRemove}\n                    onClickOutside={this.handleCancelRemove}\n                    padding=\"large\"\n                  >\n                    <div className={styles.confirmDeletePopover}>\n                      <div className={styles.confirmDeletePopoverButtons}>\n                        <ButtonCollection>\n                          <DefaultButton onClick={this.handleCancelRemove}>Cancel</DefaultButton>\n                          <DefaultButton\n                            color=\"danger\"\n                            onClick={this.handleRemoveVideo}\n                            loading={!!this.state.isLoading}\n                          >\n                            Remove\n                          </DefaultButton>\n                        </ButtonCollection>\n                      </div>\n                    </div>\n                    <div className={styles.deleteCheckboxRow}>\n                      <Checkbox\n                        checked={this.state.deleteOnMuxChecked}\n                        onChange={this.handleDeleteOnMuxCheckBoxClicked}\n                        label=\"Delete asset on MUX.com\"\n                      />\n                    </div>\n                    <div className={styles.deleteCheckboxRow}>\n                      <Checkbox\n                        disabled={this.state.deleteOnMuxChecked}\n                        checked={\n                          this.state.deleteOnMuxChecked || this.state.deleteAssetDocumentChecked\n                        }\n                        onChange={this.handleDeleteAssetDocumentCheckBoxClicked}\n                        label=\"Delete video from dataset\"\n                      />\n                    </div>\n                  </PopOver>\n                )}\n              </div>\n            </DefaultButton>\n          </Fragment>\n        )\n      }\n      return null\n    }\n\n    renderThumbPreview() {\n      return (\n        <PopOver\n          color=\"default\"\n          useOverlay\n          onClose={this.handleCloseThumbPreview}\n          onEscape={this.handleCloseThumbPreview}\n          onClickOutside={this.handleCloseThumbPreview}\n          padding=\"large\"\n        >\n          <div>\n            <h4>Saved thumbnail frame:</h4>\n            <img className={styles.thumbPreview} src={this.state.thumb} width={240} height={240} />\n          </div>\n        </PopOver>\n      )\n    }\n\n    renderBrowser() {\n      return (\n        <FullscreenDialog title=\"Select video\" onClose={this.handleCloseBrowser} isOpen>\n          <SelectAsset onSelect={this.handleSelectAsset} />\n        </FullscreenDialog>\n      )\n    }\n\n    renderError() {\n      const {error} = this.state\n      if (!error) {\n        return null\n      }\n      return (\n        <Dialog\n          title=\"Error\"\n          color=\"danger\"\n          useOverlay\n          onClose={this.handleErrorClose}\n          onEscape={this.handleErrorClose}\n          onClickOutside={this.handleErrorClose}\n        >\n          <DialogContent size=\"small\">{error.message}</DialogContent>\n        </Dialog>\n      )\n    }\n\n    render() {\n      const {type, level, markers} = this.props\n      const {isLoading, secrets, hasFocus, needsSetup, error, thumb, showBrowser} = this.state\n      return (\n        <div className={styles.root}>\n          <div className={styles.header}>\n            <FormField\n              label={type.title}\n              markers={markers}\n              description={type.description}\n              level={level}\n              className={styles.formField}\n            />\n            {this.renderSetupButton()}\n          </div>\n\n          {isLoading === 'secrets' && (\n            <div className={styles.isLoading}>\n              <Spinner inline />\n              <span>Fetching credentials</span>\n            </div>\n          )}\n\n          {this.renderSetupNotice()}\n\n          {!needsSetup && (\n            <Uploader\n              buttons={this.renderVideoButtons()}\n              hasFocus={hasFocus}\n              onBlur={this.handleBlur}\n              onFocus={this.handleFocus}\n              onSetupButtonClicked={this.handleSetupButtonClicked}\n              onUploadComplete={this.handleOnUploadComplete}\n              secrets={secrets}\n              onBrowse={this.handleBrowseButton}\n            >\n              {this.renderAsset()}\n            </Uploader>\n          )}\n\n          {thumb && this.renderThumbPreview()}\n\n          {showBrowser && this.renderBrowser()}\n\n          {error && this.renderError()}\n        </div>\n      )\n    }\n  }\n)\n"],"file":"Input.js"}